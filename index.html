<script>
  let model;

  async function loadModel() {
    // ✅ Graph model 要用 tf.loadGraphModel()
    model = await tf.loadGraphModel('tfjs_model/model.json');
  }

  loadModel();

  document.getElementById('predict-form').addEventListener('submit', async function(e) {
    e.preventDefault();

    const pm25 = parseFloat(document.getElementById('pm25').value);
    const aqi = parseFloat(document.getElementById('aqi').value);
    const temp = parseFloat(document.getElementById('temp').value);
    const age = parseInt(document.getElementById('age').value);

    const inputTensor = tf.tensor2d([[pm25, aqi, temp, age]], [1, 4]);

    // ✅ Graph model 的 predict 是傳入 dictionary（鍵為 input 名）
    const prediction = model.predict({ "input_layer_6": inputTensor });

    const result = await prediction.data();
    document.getElementById('result').textContent = `預測結果：${result[0].toFixed(2)}`;
  });
</script>
