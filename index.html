<script>
  let model;
  const mean = [36.44795455, 36.79043956, 21.94257032, 1.0];
  const std = [13.82799287, 16.38531829, 4.86021746, 0.81649658];

  async function loadModel() {
    model = await tf.loadGraphModel('./tfjs_model/model.json');
    console.log('模型已載入');
  }

  async function predict() {
    const inputs = [
      parseFloat(document.getElementById('pm25').value),
      parseFloat(document.getElementById('aqi').value),
      parseFloat(document.getElementById('temp').value),
      parseFloat(document.getElementById('age').value),
    ];

    const standardized = inputs.map((val, i) => (val - mean[i]) / std[i]);
    const inputTensor = tf.tensor2d([standardized]);

    // 替換為你的模型實際輸入名稱
    const output = model.predict({ "keras_tensor_43": inputTensor });

    const result = await output.data();
    document.getElementById('result').innerText = result[0].toFixed(2);
  }

  loadModel();
</script>
